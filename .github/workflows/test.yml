name: Test & Coverage


on:
pull_request:
push:
branches: [main]


jobs:
test:
runs-on: ubuntu-latest


services:
postgres:
image: postgres:15
env:
POSTGRES_USER: test
POSTGRES_PASSWORD: test
POSTGRES_DB: test_db
ports:
- 5432:5432
options: >-
--health-cmd="pg_isready"
--health-interval=10s
--health-timeout=5s
--health-retries=5


steps:
- uses: actions/checkout@v3


- uses: actions/setup-node@v3
with:
node-version: 18


- run: npm ci


- run: npm run test:cov


- run: npm run test:e2e